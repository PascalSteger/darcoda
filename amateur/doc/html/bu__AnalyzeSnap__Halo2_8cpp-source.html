<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>amateur: bu_AnalyzeSnap_Halo2.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>bu_AnalyzeSnap_Halo2.cpp</h1><a href="bu__AnalyzeSnap__Halo2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *   Copyright (C) 2008 by Pascal Stephan Philipp Steger                   *</span>
<a name="l00003"></a>00003 <span class="comment"> *   psteger@phys.ethz.ch                                                  *</span>
<a name="l00004"></a>00004 <span class="comment"> *                                                                         *</span>
<a name="l00005"></a>00005 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
<a name="l00006"></a>00006 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
<a name="l00007"></a>00007 <span class="comment"> *   the Free Software Foundation; either version 3 of the License, or     *</span>
<a name="l00008"></a>00008 <span class="comment"> *   (at your option) any later version.                                   *</span>
<a name="l00009"></a>00009 <span class="comment"> *                                                                         *</span>
<a name="l00010"></a>00010 <span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span>
<a name="l00011"></a>00011 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span>
<a name="l00012"></a>00012 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span>
<a name="l00013"></a>00013 <span class="comment"> *   GNU General Public License for more details.                          *</span>
<a name="l00014"></a>00014 <span class="comment"> *                                                                         *</span>
<a name="l00015"></a>00015 <span class="comment"> *   You should have received a copy of the GNU General Public License     *</span>
<a name="l00016"></a>00016 <span class="comment"> *   along with this program; if not, write to the                         *</span>
<a name="l00017"></a>00017 <span class="comment"> *   Free Software Foundation, Inc.,                                       *</span>
<a name="l00018"></a>00018 <span class="comment"> *   59 Temple Place - Suite 330, Boston, ma  02111-1307, USA.             *</span>
<a name="l00019"></a>00019 <span class="comment"> ***************************************************************************/</span>
<a name="l00020"></a>00020 
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">// inclusions</span>
<a name="l00029"></a>00029 <span class="comment"></span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;limits&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;numeric&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include "<a class="code" href="SystemCharacteristics_8h.html" title="All publicly known functions from SystemCharacteristics.cpp.">SystemCharacteristics.h</a>"</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include "<a class="code" href="Vector3_8h.html" title="All publicly known functions of Vector3.cpp A three-dimensional vector (a,b,c).">Vector3.h</a>"</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include "<a class="code" href="Matrix33_8h.html" title="All publicly known functions of Matrix33.cpp presents a 3x3 Matrix.">Matrix33.h</a>"</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="ReadGadget_8h.html" title="All publicly known functions from ReadGadget.c and template instantiations.">ReadGadget.h</a>"</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include "<a class="code" href="Simulation_8h.html">Simulation.h</a>"</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include "<a class="code" href="Halo_8h.html">Halo.h</a>"</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include "<a class="code" href="HDFIO_8h.html" title="templated C++ HDF5 frontend">HDFIO.h</a>"</span>
<a name="l00046"></a>00046 
<a name="l00048"></a>00048 <span class="comment">// overall definitions</span>
<a name="l00050"></a>00050 <span class="comment"></span>
<a name="l00051"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#00624963fadb9859c2785372d78dbf7d">00051</a> <span class="keyword">typedef</span> std::vector&lt;double&gt; <a class="code" href="AnalyzeSnap_8cpp.html#00624963fadb9859c2785372d78dbf7d">VecDouble</a>;
<a name="l00052"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#19eaba2936536c4981d32fb3556862a5">00052</a> <span class="keyword">typedef</span> std::vector&lt;std::vector &lt;double&gt; &gt; <a class="code" href="AnalyzeSnap_8cpp.html#19eaba2936536c4981d32fb3556862a5">VecVecDouble</a>;
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">00054</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a> = 4;
<a name="l00055"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">00055</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a> = 6;
<a name="l00056"></a>00056 <span class="comment">// concordance cosmology as used in Gadget2 simulation tarkin</span>
<a name="l00057"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#a98e0d80cca1b249538737548e6d83ac">00057</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="AnalyzeSnap_8cpp.html#a98e0d80cca1b249538737548e6d83ac">Omega_M</a> = 0.3;
<a name="l00058"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#a6e8e201edf24007dc075bfef6e8210c">00058</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="AnalyzeSnap_8cpp.html#a6e8e201edf24007dc075bfef6e8210c">h</a> = 0.7;
<a name="l00059"></a>00059 <span class="comment">//const double rhobox = 1.8791E-29 * Omega_M; // in gm/cm^3</span>
<a name="l00060"></a>00060 <span class="comment">//const double rhobox = 2.7757819e-8 * Omega_M / (h * h);   //in 10^10 msun/(h kpc)^3, in the units of tarkin</span>
<a name="l00061"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#1b7c170e9ea3a3ed47046eb467ec54fc">00061</a> <span class="keywordtype">double</span> <a class="code" href="AnalyzeSnap_8cpp.html#1b7c170e9ea3a3ed47046eb467ec54fc">rhobox</a> = 0.0;    <span class="comment">// gives loops over all particles, independent of overdensity</span>
<a name="l00062"></a>00062 <span class="preprocessor">#warning overdensity criterion neglected, using all particles from AHF</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00065"></a>00065 <span class="comment">// global variables</span>
<a name="l00067"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#b153b283e92c789466ce2a8c5be63b0e">00067</a> <span class="comment"></span><a class="code" href="AnalyzeSnap_8cpp.html#00624963fadb9859c2785372d78dbf7d">VecDouble</a> <a class="code" href="AnalyzeSnap_8cpp.html#374a2ca2afb5f5b9be0d0038f6542b4e">Vhp_PosCM</a>, <a class="code" href="AnalyzeSnap_8cpp.html#22ce34b612f732f61f992e25cead92b2">Vhp_PosMB</a>, <a class="code" href="AnalyzeSnap_8cpp.html#b153b283e92c789466ce2a8c5be63b0e">Vhp_VelCM</a>, <a class="code" href="AnalyzeSnap_8cpp.html#d85588f3aa5d2312c9153ae8cb68040a">Vhp_Rvir</a>, <a class="code" href="AnalyzeSnap_8cpp.html#d59448f336981875af49216ae63e804b">Vhp_Mvir</a>;
<a name="l00068"></a>00068 <a class="code" href="AnalyzeSnap_8cpp.html#19eaba2936536c4981d32fb3556862a5">VecVecDouble</a> <a class="code" href="AnalyzeSnap_8cpp.html#17b47e9a9db78ab1b79cf7e9d1129864">Vhp_Mass</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>), <a class="code" href="AnalyzeSnap_8cpp.html#1b74c34227af982ff3c462d364f736b0">Vhp_LambdaPrime</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>), <a class="code" href="AnalyzeSnap_8cpp.html#3d18c3e0a6db300e8b17ea98912cf7ec">Vhp_Sigma</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>), <a class="code" href="AnalyzeSnap_8cpp.html#952cb70c46e37a1ed847239256014843">Vhp_J</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>);
<a name="l00069"></a>00069 <span class="comment">//VecVecDouble Vhp_EVmax(HaloTypeTotal);</span>
<a name="l00070"></a>00070 <a class="code" href="AnalyzeSnap_8cpp.html#19eaba2936536c4981d32fb3556862a5">VecVecDouble</a> <a class="code" href="AnalyzeSnap_8cpp.html#c22e03994e3f040ae96f09d559a03403">Vhp_EVa</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>), <a class="code" href="AnalyzeSnap_8cpp.html#143a3c5fc9ad57cfebfd30407b724ae6">Vhp_EVb</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>), <a class="code" href="AnalyzeSnap_8cpp.html#43081fbd56759f36ad8fbcfd47a79742">Vhp_EVc</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>), <a class="code" href="AnalyzeSnap_8cpp.html#ebad48c238b8c0839e65d3a5c02233ba">Vhp_Eigenvalues</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>);
<a name="l00071"></a>00071 <span class="comment">//VecVecDouble Vhp_EW(HaloTypeTotal);</span>
<a name="l00072"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#84c1a863defbb13a0e3680b2570cedb0">00072</a> std::vector &lt; unsigned &gt; <a class="code" href="AnalyzeSnap_8cpp.html#84c1a863defbb13a0e3680b2570cedb0">Vhp_HaloParticlesCount</a>;
<a name="l00073"></a>00073 std::vector &lt; std::vector &lt; unsigned &gt; &gt; <a class="code" href="AnalyzeSnap_8cpp.html#4cc4c3c5072e41f7d7c15a24248aa20b">Vhp_HaloParticlesTypesCount</a>(<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>);
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#fd89d1cd3478c9dd65f7d4dc0eb424a8">00075</a> <a class="code" href="AnalyzeSnap_8cpp.html#00624963fadb9859c2785372d78dbf7d">VecDouble</a> <a class="code" href="AnalyzeSnap_8cpp.html#ad96b2a42991f6956c12e35c4bf01dd0">Vahf_npart</a>, <a class="code" href="AnalyzeSnap_8cpp.html#3f8d65150bf509236f89098a1b213498">Vahf_nvpart</a>, <a class="code" href="AnalyzeSnap_8cpp.html#4866184861c779ebd03c7a2a59792e18">Vahf_ovdens</a>, <a class="code" href="AnalyzeSnap_8cpp.html#fd89d1cd3478c9dd65f7d4dc0eb424a8">Vahf_sigV</a>, <a class="code" href="AnalyzeSnap_8cpp.html#01db9d90778cbdd28cbd51875c38d81e">Vahf_J</a>;
<a name="l00076"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#e06a67a2e2ed1c9ba4cb75ea791cb64a">00076</a> <a class="code" href="AnalyzeSnap_8cpp.html#00624963fadb9859c2785372d78dbf7d">VecDouble</a> <a class="code" href="AnalyzeSnap_8cpp.html#e39583c0417263714eb8bc3d4983f023">Vahf_EW</a>, <a class="code" href="AnalyzeSnap_8cpp.html#9aecabf7780ee5ec41fbb1c206ead97f">Vahf_EVa</a>, <a class="code" href="AnalyzeSnap_8cpp.html#8b9fdf27c6a6599b3eebbf1a341ee06b">Vahf_EVb</a>, <a class="code" href="AnalyzeSnap_8cpp.html#3209f2ce3fa58c57f03cb4d8e32369c7">Vahf_EVc</a>, <a class="code" href="AnalyzeSnap_8cpp.html#55e8d1b30c655163152d328cd3ab48d6">Vahf_Ekin</a>, <a class="code" href="AnalyzeSnap_8cpp.html#a9ec80f3bd3fbc9d1b83bae057ad23dc">Vahf_Epot</a>, <a class="code" href="AnalyzeSnap_8cpp.html#e06a67a2e2ed1c9ba4cb75ea791cb64a">Vahf_xc</a>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 
<a name="l00085"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#5f4ec08ca17aee191961be83ac9d1e48">00085</a> <span class="keyword">template</span> &lt; <span class="keyword">typename</span> T &gt; T <a class="code" href="AnalyzeSnap_8cpp.html#5f4ec08ca17aee191961be83ac9d1e48">byteorder</a>(T v)
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087   T val;
<a name="l00088"></a>00088   (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;val))[3] =
<a name="l00089"></a>00089     (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;v))[0];
<a name="l00090"></a>00090   (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;val))[2] =
<a name="l00091"></a>00091     (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;v))[1];
<a name="l00092"></a>00092   (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;val))[1] =
<a name="l00093"></a>00093     (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;v))[2];
<a name="l00094"></a>00094   (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;val))[0] =
<a name="l00095"></a>00095     (reinterpret_cast &lt; <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *&gt;(&amp;v))[3];
<a name="l00096"></a>00096   <span class="keywordflow">return</span> val;
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="comment">/*</span>
<a name="l00100"></a>00100 <span class="comment"> * reads the ahfstep output files and pushes the values onto vectors</span>
<a name="l00101"></a>00101 <span class="comment"> * @param isnap: which snapshot are we looking at?</span>
<a name="l00102"></a>00102 <span class="comment"> */</span>
<a name="l00103"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#46c32ccad62a2215cbf8c0d9311e9094">00103</a> <span class="keywordtype">void</span> <a class="code" href="AnalyzeSnap_8cpp.html#46c32ccad62a2215cbf8c0d9311e9094">Storeahf</a>(<span class="keywordtype">int</span> isnap)
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105   <span class="keywordtype">unsigned</span> ahf_npart, ahf_nvpart;
<a name="l00106"></a>00106   <span class="keywordtype">float</span> ahf_Xc, ahf_Yc, ahf_Zc, ahf_VXc, ahf_VYc, ahf_VZc;
<a name="l00107"></a>00107   <span class="keywordtype">float</span> ahf_Mvir, ahf_Rvir, ahf_Vmax, ahf_Rmax, ahf_sigV;
<a name="l00108"></a>00108   <span class="keywordtype">float</span> ahf_lambda, ahf_Jx, ahf_Jy, ahf_Jz;
<a name="l00109"></a>00109   <span class="keywordtype">float</span> ahf_a, ahf_Eax, ahf_Eay, ahf_Eaz;
<a name="l00110"></a>00110   <span class="keywordtype">float</span> ahf_b, ahf_Ebx, ahf_Eby, ahf_Ebz;
<a name="l00111"></a>00111   <span class="keywordtype">float</span> ahf_c, ahf_Ecx, ahf_Ecy, ahf_Ecz;
<a name="l00112"></a>00112   <span class="keywordtype">float</span> ahf_ovdens, ahf_Redge;
<a name="l00113"></a>00113   <span class="keywordtype">int</span> ahf_nbins;
<a name="l00114"></a>00114   <span class="keywordtype">float</span> ahf_Ekin, ahf_Epot;
<a name="l00115"></a>00115   <span class="keywordtype">float</span> ahf_mbp_offset, ahf_com_offset;
<a name="l00116"></a>00116   <span class="keywordtype">float</span> ahf_r2, ahf_lambdaE;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   std::fstream ahfhalos((<a class="code" href="SystemCharacteristics_8cpp.html#d3867aaa410297f271cb4a5f443f368c">Folder</a>(<span class="stringliteral">"output"</span>) + <a class="code" href="SystemCharacteristics_8cpp.html#b95a6a07eed667f94b0951a15f1a9b0e">Snaps</a>(isnap) + <span class="stringliteral">"/ahf_out_halos"</span>).c_str(), std::ios::in);
<a name="l00119"></a>00119   ahfhalos &gt;&gt; ahf_npart &gt;&gt; ahf_nvpart&gt;&gt; ahf_Xc    &gt;&gt; ahf_Yc   &gt;&gt; ahf_Zc
<a name="l00120"></a>00120        &gt;&gt; ahf_VXc   &gt;&gt; ahf_VYc   &gt;&gt; ahf_VZc
<a name="l00121"></a>00121        &gt;&gt; ahf_Mvir  &gt;&gt; ahf_Rvir
<a name="l00122"></a>00122        &gt;&gt; ahf_Vmax  &gt;&gt; ahf_Rmax
<a name="l00123"></a>00123        &gt;&gt; ahf_sigV
<a name="l00124"></a>00124        &gt;&gt; ahf_lambda
<a name="l00125"></a>00125        &gt;&gt; ahf_Jx    &gt;&gt; ahf_Jy    &gt;&gt; ahf_Jz
<a name="l00126"></a>00126        &gt;&gt; ahf_a     &gt;&gt; ahf_Eax   &gt;&gt; ahf_Eay   &gt;&gt; ahf_Eaz
<a name="l00127"></a>00127        &gt;&gt; ahf_b     &gt;&gt; ahf_Ebx   &gt;&gt; ahf_Eby   &gt;&gt; ahf_Ebz
<a name="l00128"></a>00128        &gt;&gt; ahf_c     &gt;&gt; ahf_Ecx   &gt;&gt; ahf_Ecy   &gt;&gt; ahf_Ecz
<a name="l00129"></a>00129        &gt;&gt; ahf_ovdens
<a name="l00130"></a>00130        &gt;&gt; ahf_Redge
<a name="l00131"></a>00131        &gt;&gt; ahf_nbins
<a name="l00132"></a>00132        &gt;&gt; ahf_Ekin   &gt;&gt; ahf_Epot 
<a name="l00133"></a>00133        &gt;&gt; ahf_mbp_offset &gt;&gt; ahf_com_offset 
<a name="l00134"></a>00134        &gt;&gt; ahf_r2 
<a name="l00135"></a>00135        &gt;&gt; ahf_lambdaE;
<a name="l00136"></a>00136   ahfhalos.close();
<a name="l00137"></a>00137   
<a name="l00138"></a>00138   <a class="code" href="AnalyzeSnap_8cpp.html#e06a67a2e2ed1c9ba4cb75ea791cb64a">Vahf_xc</a>.push_back(ahf_Xc);  <a class="code" href="AnalyzeSnap_8cpp.html#e06a67a2e2ed1c9ba4cb75ea791cb64a">Vahf_xc</a>.push_back(ahf_Yc);  <a class="code" href="AnalyzeSnap_8cpp.html#e06a67a2e2ed1c9ba4cb75ea791cb64a">Vahf_xc</a>.push_back(ahf_Zc);
<a name="l00139"></a>00139   <a class="code" href="AnalyzeSnap_8cpp.html#ad96b2a42991f6956c12e35c4bf01dd0">Vahf_npart</a>.push_back(ahf_npart);  <a class="code" href="AnalyzeSnap_8cpp.html#3f8d65150bf509236f89098a1b213498">Vahf_nvpart</a>.push_back(ahf_nvpart);
<a name="l00140"></a>00140   <a class="code" href="AnalyzeSnap_8cpp.html#4866184861c779ebd03c7a2a59792e18">Vahf_ovdens</a>.push_back(ahf_ovdens);
<a name="l00141"></a>00141   <a class="code" href="AnalyzeSnap_8cpp.html#fd89d1cd3478c9dd65f7d4dc0eb424a8">Vahf_sigV</a>.push_back(ahf_sigV);
<a name="l00142"></a>00142   <a class="code" href="AnalyzeSnap_8cpp.html#01db9d90778cbdd28cbd51875c38d81e">Vahf_J</a>.push_back(ahf_Jx);  <a class="code" href="AnalyzeSnap_8cpp.html#01db9d90778cbdd28cbd51875c38d81e">Vahf_J</a>.push_back(ahf_Jy);  <a class="code" href="AnalyzeSnap_8cpp.html#01db9d90778cbdd28cbd51875c38d81e">Vahf_J</a>.push_back(ahf_Jz);
<a name="l00143"></a>00143   <a class="code" href="AnalyzeSnap_8cpp.html#e39583c0417263714eb8bc3d4983f023">Vahf_EW</a>.push_back(ahf_a);  <a class="code" href="AnalyzeSnap_8cpp.html#e39583c0417263714eb8bc3d4983f023">Vahf_EW</a>.push_back(ahf_b);  <a class="code" href="AnalyzeSnap_8cpp.html#e39583c0417263714eb8bc3d4983f023">Vahf_EW</a>.push_back(ahf_c);
<a name="l00144"></a>00144   <a class="code" href="AnalyzeSnap_8cpp.html#9aecabf7780ee5ec41fbb1c206ead97f">Vahf_EVa</a>.push_back(ahf_Eax);  <a class="code" href="AnalyzeSnap_8cpp.html#9aecabf7780ee5ec41fbb1c206ead97f">Vahf_EVa</a>.push_back(ahf_Eay);  <a class="code" href="AnalyzeSnap_8cpp.html#9aecabf7780ee5ec41fbb1c206ead97f">Vahf_EVa</a>.push_back(ahf_Eaz);
<a name="l00145"></a>00145   <a class="code" href="AnalyzeSnap_8cpp.html#8b9fdf27c6a6599b3eebbf1a341ee06b">Vahf_EVb</a>.push_back(ahf_Ebx);  <a class="code" href="AnalyzeSnap_8cpp.html#8b9fdf27c6a6599b3eebbf1a341ee06b">Vahf_EVb</a>.push_back(ahf_Eby);  <a class="code" href="AnalyzeSnap_8cpp.html#8b9fdf27c6a6599b3eebbf1a341ee06b">Vahf_EVb</a>.push_back(ahf_Ebz);
<a name="l00146"></a>00146   <a class="code" href="AnalyzeSnap_8cpp.html#3209f2ce3fa58c57f03cb4d8e32369c7">Vahf_EVc</a>.push_back(ahf_Ecx);  <a class="code" href="AnalyzeSnap_8cpp.html#3209f2ce3fa58c57f03cb4d8e32369c7">Vahf_EVc</a>.push_back(ahf_Ecy);  <a class="code" href="AnalyzeSnap_8cpp.html#3209f2ce3fa58c57f03cb4d8e32369c7">Vahf_EVc</a>.push_back(ahf_Ecz);
<a name="l00147"></a>00147   <a class="code" href="AnalyzeSnap_8cpp.html#55e8d1b30c655163152d328cd3ab48d6">Vahf_Ekin</a>.push_back(ahf_Ekin);  <a class="code" href="AnalyzeSnap_8cpp.html#a9ec80f3bd3fbc9d1b83bae057ad23dc">Vahf_Epot</a>.push_back(ahf_Epot);
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 
<a name="l00158"></a>00158 <span class="keywordtype">void</span>
<a name="l00159"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#83176b9b9f1be1130b6d6ea1492db992">00159</a> <a class="code" href="AnalyzeSnap_8cpp.html#83176b9b9f1be1130b6d6ea1492db992" title="write all calculated properties into a HDF5 file This function takes all publicly...">WriteHDF5</a>(std::string filename, <span class="keywordtype">double</span> Boxsize, <span class="keywordtype">double</span> Redshift,
<a name="l00160"></a>00160       <span class="keywordtype">double</span> HaloTotCount)
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162   <a class="code" href="HDFIO_8h.html#a4eeddaee70eb3ce64662c7d5a0e3687">HDFCreateFile</a>(filename);
<a name="l00163"></a>00163   <a class="code" href="HDFIO_8h.html#dfafd5685316cd050ad282b7837e7f05">HDFCreateGroup</a>(filename, <span class="stringliteral">"Header"</span>);
<a name="l00164"></a>00164   <a class="code" href="HDFIO_8h.html#93cc34de059a978c3b65e4a2fdd8bbc8">HDFWriteGroupAttribute</a>(filename, <span class="stringliteral">"Header"</span>, <span class="stringliteral">"Boxsize"</span>, Boxsize);
<a name="l00165"></a>00165   <a class="code" href="HDFIO_8h.html#93cc34de059a978c3b65e4a2fdd8bbc8">HDFWriteGroupAttribute</a>(filename, <span class="stringliteral">"Header"</span>, <span class="stringliteral">"Redshift"</span>, Redshift);
<a name="l00166"></a>00166   <a class="code" href="HDFIO_8h.html#93cc34de059a978c3b65e4a2fdd8bbc8">HDFWriteGroupAttribute</a>(filename, <span class="stringliteral">"Header"</span>, <span class="stringliteral">"NumHalos"</span>, HaloTotCount);
<a name="l00167"></a>00167   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_HaloParticlesCount"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#84c1a863defbb13a0e3680b2570cedb0">Vhp_HaloParticlesCount</a>);
<a name="l00168"></a>00168   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_PosCM"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#374a2ca2afb5f5b9be0d0038f6542b4e">Vhp_PosCM</a>);
<a name="l00169"></a>00169   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_PosMB"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#22ce34b612f732f61f992e25cead92b2">Vhp_PosMB</a>);
<a name="l00170"></a>00170   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_VelCM"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#b153b283e92c789466ce2a8c5be63b0e">Vhp_VelCM</a>);
<a name="l00171"></a>00171   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_Rvir"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#d85588f3aa5d2312c9153ae8cb68040a">Vhp_Rvir</a>);
<a name="l00172"></a>00172   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_Mvir"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#d59448f336981875af49216ae63e804b">Vhp_Mvir</a>);
<a name="l00173"></a>00173   std::string count[<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>]={<span class="stringliteral">"0"</span>,<span class="stringliteral">"1"</span>,<span class="stringliteral">"2"</span>,<span class="stringliteral">"3"</span>};
<a name="l00174"></a>00174   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>; ++i){
<a name="l00175"></a>00175     <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_LambdaPrime_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#1b74c34227af982ff3c462d364f736b0">Vhp_LambdaPrime</a>.at(i));
<a name="l00176"></a>00176     <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_Mass_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#17b47e9a9db78ab1b79cf7e9d1129864">Vhp_Mass</a>.at(i));
<a name="l00177"></a>00177     <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_Sigma_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#3d18c3e0a6db300e8b17ea98912cf7ec">Vhp_Sigma</a>.at(i));
<a name="l00178"></a>00178     <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_J_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#952cb70c46e37a1ed847239256014843">Vhp_J</a>.at(i));
<a name="l00179"></a>00179     <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_EVa_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#c22e03994e3f040ae96f09d559a03403">Vhp_EVa</a>.at(i));
<a name="l00180"></a>00180     <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_EVb_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#143a3c5fc9ad57cfebfd30407b724ae6">Vhp_EVb</a>.at(i));
<a name="l00181"></a>00181     <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_EVc_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#43081fbd56759f36ad8fbcfd47a79742">Vhp_EVc</a>.at(i));
<a name="l00182"></a>00182     <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"hp_EW_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#ebad48c238b8c0839e65d3a5c02233ba">Vhp_Eigenvalues</a>.at(i));
<a name="l00183"></a>00183     <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"hp_HaloParticlesTypesCount_"</span>+count[i], <a class="code" href="AnalyzeSnap_8cpp.html#4cc4c3c5072e41f7d7c15a24248aa20b">Vhp_HaloParticlesTypesCount</a>.at(i));
<a name="l00184"></a>00184   }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"ahf_npart"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#ad96b2a42991f6956c12e35c4bf01dd0">Vahf_npart</a>);
<a name="l00187"></a>00187   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"ahf_xc"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#e06a67a2e2ed1c9ba4cb75ea791cb64a">Vahf_xc</a>);
<a name="l00188"></a>00188   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"ahf_nvpart"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#3f8d65150bf509236f89098a1b213498">Vahf_nvpart</a>);
<a name="l00189"></a>00189   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"ahf_ovdens"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#4866184861c779ebd03c7a2a59792e18">Vahf_ovdens</a>);
<a name="l00190"></a>00190   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"ahf_sigV"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#fd89d1cd3478c9dd65f7d4dc0eb424a8">Vahf_sigV</a>);
<a name="l00191"></a>00191   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"ahf_J"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#01db9d90778cbdd28cbd51875c38d81e">Vahf_J</a>);
<a name="l00192"></a>00192   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"ahf_EW"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#e39583c0417263714eb8bc3d4983f023">Vahf_EW</a>);
<a name="l00193"></a>00193   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"ahf_EVa"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#9aecabf7780ee5ec41fbb1c206ead97f">Vahf_EVa</a>);
<a name="l00194"></a>00194   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"ahf_EVb"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#8b9fdf27c6a6599b3eebbf1a341ee06b">Vahf_EVb</a>);
<a name="l00195"></a>00195   <a class="code" href="HDFIO_8h.html#2beb19611043d3393a282ae7a2810075">HDFWriteDatasetVector</a>(filename, <span class="stringliteral">"ahf_EVc"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#3209f2ce3fa58c57f03cb4d8e32369c7">Vahf_EVc</a>);
<a name="l00196"></a>00196   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"ahf_Ekin"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#55e8d1b30c655163152d328cd3ab48d6">Vahf_Ekin</a>);
<a name="l00197"></a>00197   <a class="code" href="HDFIO_8h.html#a73a8d13c03b62b0a709d7e7248f0ca7">HDFWriteDataset</a>(filename, <span class="stringliteral">"ahf_Epot"</span>, <a class="code" href="AnalyzeSnap_8cpp.html#a9ec80f3bd3fbc9d1b83bae057ad23dc">Vahf_Epot</a>);
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00203"></a>00203 <span class="comment">/* Get the particle ID offsets of the different particle types</span>
<a name="l00204"></a>00204 <span class="comment"> * \param ParticleIDOffset, unsigned*: where the offsets are stored</span>
<a name="l00205"></a>00205 <span class="comment"> * \param npart, unsigned*: counts of particles types</span>
<a name="l00206"></a>00206 <span class="comment"> */</span>
<a name="l00207"></a>00207 <span class="keywordtype">void</span>
<a name="l00208"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#fae3a184f26b7f4398f94e4927188291">00208</a> <a class="code" href="AnalyzeSnap_8cpp.html#fae3a184f26b7f4398f94e4927188291" title="Return offsets of particle types inside snapshot.">GetOffsets</a>(<span class="keywordtype">unsigned</span>* ParticleIDOffsets, <span class="keywordtype">unsigned</span>* npart)
<a name="l00209"></a>00209 {
<a name="l00210"></a>00210   std::cout &lt;&lt; <span class="stringliteral">"offsets: "</span>;
<a name="l00211"></a>00211   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>; ++x) {
<a name="l00212"></a>00212     ParticleIDOffsets[x] = std::accumulate(&amp;npart[0], &amp;npart[x], 0);
<a name="l00213"></a>00213     std::cout &lt;&lt; ParticleIDOffsets[x] &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l00214"></a>00214   }
<a name="l00215"></a>00215   std::cout &lt;&lt; std::endl;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00229"></a>00229 <span class="keywordtype">void</span> 
<a name="l00230"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#97d48ae1026d702b6dcfec81079475a2">00230</a> <a class="code" href="AnalyzeSnap_8cpp.html#97d48ae1026d702b6dcfec81079475a2" title="Read snapshot data.">ReadDataBlocks</a>(std::string SnapshotFilename, <span class="keywordtype">int</span> TotalNOParticles,
<a name="l00231"></a>00231            <span class="keywordtype">int</span>* &amp; <span class="keywordtype">id</span>, <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; pos, <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; vel, <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; mass){
<a name="l00232"></a>00232   FILE *SnapshotFile = 0;
<a name="l00233"></a>00233   SnapshotFile = fopen(SnapshotFilename.c_str(), <span class="stringliteral">"r"</span>);
<a name="l00234"></a>00234   <span class="keywordtype">int</span> n = 0;
<a name="l00235"></a>00235   n = <a class="code" href="ReadGadget_8c.html#82dcfc276c58b845497a7ac210b79fa4">read_gadget_1</a>((<span class="keywordtype">int</span> *) <span class="keywordtype">id</span>, <span class="stringliteral">"ID  "</span>, SnapshotFile);
<a name="l00236"></a>00236   
<a name="l00237"></a>00237   <span class="keywordtype">float</span> *ftemp = <span class="keyword">new</span> <span class="keywordtype">float</span>[3 * TotalNOParticles];
<a name="l00238"></a>00238   n = <a class="code" href="ReadGadget_8c.html#d94fb9be5ec96b09a94fa083db81463c">read_gadget_3</a>(ftemp, <span class="stringliteral">"POS "</span>, SnapshotFile);
<a name="l00239"></a>00239   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 3 * n; ++ii)
<a name="l00240"></a>00240     pos[ii] = ftemp[ii];
<a name="l00241"></a>00241   
<a name="l00242"></a>00242   n = <a class="code" href="ReadGadget_8c.html#d94fb9be5ec96b09a94fa083db81463c">read_gadget_3</a>(ftemp, <span class="stringliteral">"VEL "</span>, SnapshotFile);
<a name="l00243"></a>00243   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 3 * n; ++ii)
<a name="l00244"></a>00244     vel[ii] = ftemp[ii];
<a name="l00245"></a>00245   
<a name="l00246"></a>00246   n = <a class="code" href="ReadGadget_8c.html#82dcfc276c58b845497a7ac210b79fa4">read_gadget_1</a>(ftemp, <span class="stringliteral">"MASS"</span>, SnapshotFile);
<a name="l00247"></a>00247   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; n; ++ii)
<a name="l00248"></a>00248     mass[ii] = ftemp[ii];
<a name="l00249"></a>00249   
<a name="l00250"></a>00250   <span class="keyword">delete</span>[] ftemp;
<a name="l00251"></a>00251   fclose(SnapshotFile);
<a name="l00252"></a>00252   <span class="keywordflow">return</span>;
<a name="l00253"></a>00253 }
<a name="l00254"></a>00254 
<a name="l00262"></a>00262 <span class="keywordtype">void</span> 
<a name="l00263"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#cff9f390ba24b053759db4cd5a6f4423">00263</a> <a class="code" href="AnalyzeSnap_8cpp.html#07f732b0c1b2b63a40dd8ae52850f50b" title="Open the ahf_out_particles file take ifstream and open particles file with it.">openParticlesFile</a>(<span class="keywordtype">unsigned</span> isnap, std::ifstream &amp; SnapshotParticles){
<a name="l00264"></a>00264   std::string SnapshotParticlesFilename =
<a name="l00265"></a>00265     <a class="code" href="SystemCharacteristics_8cpp.html#d3867aaa410297f271cb4a5f443f368c">Folder</a>(<span class="stringliteral">"output"</span>) + <a class="code" href="SystemCharacteristics_8cpp.html#b95a6a07eed667f94b0951a15f1a9b0e">Snaps</a>(isnap) + <span class="stringliteral">"/ahf_out_particles"</span>;
<a name="l00266"></a>00266   SnapshotParticles.open(SnapshotParticlesFilename.c_str(),
<a name="l00267"></a>00267              std::ios_base::in | std::ios_base::binary);
<a name="l00268"></a>00268   <span class="keywordflow">return</span>;
<a name="l00269"></a>00269 }
<a name="l00270"></a>00270 
<a name="l00282"></a>00282 <span class="keywordtype">void</span> 
<a name="l00283"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#ac7f4e8e49192d6ed40adaa5bd066a18">00283</a> <a class="code" href="AnalyzeSnap_8cpp.html#ac7f4e8e49192d6ed40adaa5bd066a18" title="Push back all HP outputs for the different halos Push back onto the Vhp_ vectors...">PushBackHPoutput</a>(<span class="keywordtype">unsigned</span> HaloTypeIterator, <a class="code" href="classVector3.html">Vector3</a> J, std::vector&lt;Vector3&gt; Eigenvectors, <a class="code" href="classVector3.html">Vector3</a> Eigenvalues, 
<a name="l00284"></a>00284          <span class="keywordtype">double</span> lambda, <span class="keywordtype">double</span> Mtot, <span class="keywordtype">double</span> Sigma){
<a name="l00285"></a>00285   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j&lt;3; ++j) {
<a name="l00286"></a>00286     <a class="code" href="AnalyzeSnap_8cpp.html#952cb70c46e37a1ed847239256014843">Vhp_J</a>.at(HaloTypeIterator).push_back(J(j));
<a name="l00287"></a>00287     <a class="code" href="AnalyzeSnap_8cpp.html#c22e03994e3f040ae96f09d559a03403">Vhp_EVa</a>.at(HaloTypeIterator).push_back((Eigenvectors.at(0))(j));
<a name="l00288"></a>00288     <a class="code" href="AnalyzeSnap_8cpp.html#143a3c5fc9ad57cfebfd30407b724ae6">Vhp_EVb</a>.at(HaloTypeIterator).push_back((Eigenvectors.at(1))(j));
<a name="l00289"></a>00289     <a class="code" href="AnalyzeSnap_8cpp.html#43081fbd56759f36ad8fbcfd47a79742">Vhp_EVc</a>.at(HaloTypeIterator).push_back((Eigenvectors.at(2))(j));
<a name="l00290"></a>00290     <a class="code" href="AnalyzeSnap_8cpp.html#ebad48c238b8c0839e65d3a5c02233ba">Vhp_Eigenvalues</a>.at(HaloTypeIterator).push_back((Eigenvalues)(j));
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292   <a class="code" href="AnalyzeSnap_8cpp.html#1b74c34227af982ff3c462d364f736b0">Vhp_LambdaPrime</a>.at(HaloTypeIterator).push_back(lambda);
<a name="l00293"></a>00293   <a class="code" href="AnalyzeSnap_8cpp.html#17b47e9a9db78ab1b79cf7e9d1129864">Vhp_Mass</a>.at(HaloTypeIterator).push_back(Mtot);
<a name="l00294"></a>00294   <a class="code" href="AnalyzeSnap_8cpp.html#3d18c3e0a6db300e8b17ea98912cf7ec">Vhp_Sigma</a>.at(HaloTypeIterator).push_back(Sigma);
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00305"></a>00305 <span class="keywordtype">void</span>
<a name="l00306"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#5c8deb1c4b5f6c449b45b8af345d0333">00306</a> <a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#5c8deb1c4b5f6c449b45b8af345d0333" title="Read a halo full of snapshot particles from ahf_out_particles Read in a slab of HaloPopulation...">ReadSnapParticlesBunch</a>(std::ifstream &amp; SnapshotParticles, <span class="keywordtype">unsigned</span> HaloPopulation,
<a name="l00307"></a>00307                <span class="keywordtype">unsigned</span>* &amp; ParticleIndexID, <span class="keywordtype">int</span>* &amp; ParticleIndexType){
<a name="l00308"></a>00308   <span class="keywordtype">unsigned</span> ParticleID = 0;
<a name="l00309"></a>00309   <span class="keywordtype">int</span> ParticleType = 0;
<a name="l00310"></a>00310   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; HaloPopulation; ++i) {
<a name="l00311"></a>00311     SnapshotParticles &gt;&gt; ParticleID;
<a name="l00312"></a>00312     SnapshotParticles &gt;&gt; ParticleType;
<a name="l00313"></a>00313     ParticleIndexID[i] = ParticleID;
<a name="l00314"></a>00314     ParticleIndexType[i] = ParticleType;
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316 }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 
<a name="l00330"></a>00330 <span class="keywordtype">void</span>
<a name="l00331"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#e961128092ad9650ca0d54b8a2879a67">00331</a> <a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#e961128092ad9650ca0d54b8a2879a67" title="preparing halo2 change position of values in pos, vel, mass according to particle...">GenerateHalo2</a>(<span class="keywordtype">unsigned</span> HaloPopulation, std::ifstream &amp; SnapshotParticles,
<a name="l00332"></a>00332           <span class="keyword">const</span> std::map&lt;int,unsigned&gt;&amp; DoubleIndexMapi,
<a name="l00333"></a>00333           <span class="keywordtype">unsigned</span>* &amp; ParticleCounter, <span class="keywordtype">unsigned</span>* &amp; ParticleOffset,
<a name="l00334"></a>00334           <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; pos,  <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; vel, <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; mass,
<a name="l00335"></a>00335           <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; pos2, <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; vel2, <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>* &amp; mass2){
<a name="l00336"></a>00336 
<a name="l00337"></a>00337   std::cout &lt;&lt; <span class="stringliteral">" * * Reading particles from ahf_out_particles..."</span> &lt;&lt; std::endl;
<a name="l00338"></a>00338   <span class="keywordtype">unsigned</span> *ParticleIndexID = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[HaloPopulation];
<a name="l00339"></a>00339   <span class="keywordtype">int</span> *ParticleIndexType = <span class="keyword">new</span> <span class="keywordtype">int</span>[HaloPopulation];
<a name="l00340"></a>00340   <a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#5c8deb1c4b5f6c449b45b8af345d0333" title="Read a halo full of snapshot particles from ahf_out_particles Read in a slab of HaloPopulation...">ReadSnapParticlesBunch</a>(SnapshotParticles, HaloPopulation, ParticleIndexID, ParticleIndexType);
<a name="l00341"></a>00341   
<a name="l00342"></a>00342   <span class="keywordtype">unsigned</span> HaloParticleIDOffsets[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>] = { 0, 0, 0, 0, 0, 0 };
<a name="l00343"></a>00343   <span class="keywordtype">unsigned</span> HPIDO[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>] = { 0, 0, 0, 0, 0, 0 };
<a name="l00344"></a>00344 
<a name="l00345"></a>00345   std::cout &lt;&lt; <span class="stringliteral">" * * Getting index positions of particles in the cluster..."</span> &lt;&lt; std::endl;  
<a name="l00346"></a>00346   std::cout &lt;&lt; <span class="stringliteral">" * * Determine particle ID offsets for this specific halo..."</span> &lt;&lt; std::endl;
<a name="l00347"></a>00347   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; HaloPopulation; ++k)
<a name="l00348"></a>00348     HPIDO[ParticleIndexType[k]]++; <span class="comment">// count the number of particles of a given type in this halo</span>
<a name="l00349"></a>00349   <span class="comment">// output</span>
<a name="l00350"></a>00350   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> HaloTypeIterator = 0; HaloTypeIterator &lt; <a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>; ++HaloTypeIterator)
<a name="l00351"></a>00351     <a class="code" href="AnalyzeSnap_8cpp.html#4cc4c3c5072e41f7d7c15a24248aa20b">Vhp_HaloParticlesTypesCount</a>.at(HaloTypeIterator).push_back(HPIDO[HaloTypeIterator]);
<a name="l00352"></a>00352   <span class="comment">// accumulation</span>
<a name="l00353"></a>00353   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>; ++x)
<a name="l00354"></a>00354     HaloParticleIDOffsets[x] = std::accumulate(&amp;HPIDO[0], &amp;HPIDO[x], 0);
<a name="l00355"></a>00355   <span class="comment">// save offset vectors</span>
<a name="l00356"></a>00356   ParticleOffset[0] = HaloParticleIDOffsets[0];
<a name="l00357"></a>00357   ParticleOffset[1] = HaloParticleIDOffsets[0];
<a name="l00358"></a>00358   ParticleOffset[2] = HaloParticleIDOffsets[1];
<a name="l00359"></a>00359   ParticleOffset[3] = HaloParticleIDOffsets[4];
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   std::cout &lt;&lt; <span class="stringliteral">" * * generating halo2..."</span> &lt;&lt; std::endl;
<a name="l00362"></a>00362   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; HaloPopulation; ++k) {
<a name="l00363"></a>00363     <span class="comment">// putting entry in new list at right position:</span>
<a name="l00364"></a>00364     <span class="comment">// we know the particle offset (inside halo) and</span>
<a name="l00365"></a>00365     <span class="comment">// the number of particles of a given type accounted so far</span>
<a name="l00366"></a>00366     <span class="keywordtype">unsigned</span> ptype = ParticleIndexType[k];
<a name="l00367"></a>00367     assert(ptype &lt; 6);
<a name="l00368"></a>00368     <span class="keywordtype">int</span> pii = ParticleIndexID[k];
<a name="l00369"></a>00369     <span class="keywordtype">unsigned</span> offset1 = DoubleIndexMapi.find(pii)-&gt;second;
<a name="l00370"></a>00370     <span class="keywordtype">unsigned</span> offset2 = HaloParticleIDOffsets[ptype] + ParticleCounter[ptype];
<a name="l00371"></a>00371     
<a name="l00372"></a>00372     mass2[offset2] = mass[offset1];
<a name="l00373"></a>00373     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {
<a name="l00374"></a>00374       pos2[3 * offset2 + i] = pos[3*offset1+i];
<a name="l00375"></a>00375       vel2[3 * offset2 + i] = vel[3*offset1+i];
<a name="l00376"></a>00376     }
<a name="l00377"></a>00377     ++ParticleCounter[ptype];
<a name="l00378"></a>00378   }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   <span class="keyword">delete</span>[] ParticleIndexType;
<a name="l00381"></a>00381   <span class="keyword">delete</span>[] ParticleIndexID;
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00390"></a>00390 <span class="keywordtype">void</span> 
<a name="l00391"></a><a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#deb9f0fc17baa68b04ea3e4f96764400">00391</a> <a class="code" href="AnalyzeSnap_8cpp.html#deb9f0fc17baa68b04ea3e4f96764400" title="Analysis of one single snapshot file Analyzes a single snapshot file.">AnalyzeSnap</a>(<span class="keywordtype">unsigned</span> isnap)
<a name="l00392"></a>00392 {
<a name="l00394"></a>00394 <span class="comment">// preparation</span>
<a name="l00396"></a>00396 <span class="comment"></span>
<a name="l00397"></a>00397   <span class="keywordtype">unsigned</span> TotalNOParticles, npart[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>];
<a name="l00398"></a>00398   <span class="keywordtype">unsigned</span> id_min[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>], id_max[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>];
<a name="l00399"></a>00399   <span class="keywordtype">double</span> Redshift, Boxsize;
<a name="l00400"></a>00400   <span class="keywordtype">double</span> Masses[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>];
<a name="l00401"></a>00401 
<a name="l00402"></a>00402   <a class="code" href="ReadGadget_8c.html#275b45dee34efc2ef2f3bb402ca17993">get_particle_number</a>((<a class="code" href="SystemCharacteristics_8cpp.html#d3867aaa410297f271cb4a5f443f368c">Folder</a>(<span class="stringliteral">"snaps"</span>)+<a class="code" href="SystemCharacteristics_8cpp.html#b95a6a07eed667f94b0951a15f1a9b0e">Snaps</a>(isnap)).c_str(), id_min, id_max, Masses,
<a name="l00403"></a>00403               npart, TotalNOParticles, Redshift, Boxsize);
<a name="l00404"></a>00404 
<a name="l00405"></a>00405   std::ifstream SnapshotParticles;
<a name="l00406"></a>00406   <a class="code" href="AnalyzeSnap_8cpp.html#07f732b0c1b2b63a40dd8ae52850f50b" title="Open the ahf_out_particles file take ifstream and open particles file with it.">openParticlesFile</a>(isnap, SnapshotParticles);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <span class="keywordtype">unsigned</span> HaloTotCount = 0;
<a name="l00409"></a>00409   SnapshotParticles &gt;&gt; HaloTotCount;
<a name="l00410"></a>00410   std::cout &lt;&lt; HaloTotCount &lt;&lt; <span class="stringliteral">" halos totally."</span> &lt;&lt; std::endl;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="keywordtype">int</span> *<span class="keywordtype">id</span> = <span class="keyword">new</span> <span class="keywordtype">int</span>[TotalNOParticles];
<a name="l00413"></a>00413   <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> *pos = <span class="keyword">new</span> <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>[3 * TotalNOParticles];
<a name="l00414"></a>00414   <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> *vel = <span class="keyword">new</span> <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>[3 * TotalNOParticles];
<a name="l00415"></a>00415   <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> *mass = <span class="keyword">new</span> <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>[TotalNOParticles];  <span class="comment">//, * temp, * u, * rho;</span>
<a name="l00416"></a>00416   <a class="code" href="AnalyzeSnap_8cpp.html#97d48ae1026d702b6dcfec81079475a2" title="Read snapshot data.">ReadDataBlocks</a>(<a class="code" href="SystemCharacteristics_8cpp.html#d3867aaa410297f271cb4a5f443f368c">Folder</a>(<span class="stringliteral">"snaps"</span>)+<a class="code" href="SystemCharacteristics_8cpp.html#b95a6a07eed667f94b0951a15f1a9b0e">Snaps</a>(isnap), TotalNOParticles, <span class="keywordtype">id</span>, pos, vel, mass);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418   <span class="keywordtype">unsigned</span> ParticleIDOffsets[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>];
<a name="l00419"></a>00419   <a class="code" href="AnalyzeSnap_8cpp.html#fae3a184f26b7f4398f94e4927188291" title="Return offsets of particle types inside snapshot.">GetOffsets</a>(&amp;ParticleIDOffsets[0], &amp;npart[0]);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421   std::map&lt;int,unsigned&gt; DoubleIndexMap;
<a name="l00422"></a>00422   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; TotalNOParticles; ++j)
<a name="l00423"></a>00423     DoubleIndexMap.insert(std::make_pair(<span class="keywordtype">id</span>[j], j));
<a name="l00424"></a>00424 
<a name="l00426"></a>00426 <span class="comment">// big loop over all halos</span>
<a name="l00428"></a>00428 <span class="comment"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> HaloIterator = 0; HaloIterator &lt; HaloTotCount; ++HaloIterator) {
<a name="l00429"></a>00429     std::cout &lt;&lt; <span class="stringliteral">"Halo "</span> &lt;&lt; HaloIterator &lt;&lt; std::endl;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <span class="keywordtype">unsigned</span> HaloPopulation;
<a name="l00432"></a>00432     SnapshotParticles &gt;&gt; HaloPopulation;
<a name="l00433"></a>00433     <a class="code" href="AnalyzeSnap_8cpp.html#84c1a863defbb13a0e3680b2570cedb0">Vhp_HaloParticlesCount</a>.push_back(HaloPopulation);
<a name="l00434"></a>00434     std::cout &lt;&lt; <span class="stringliteral">"Halo Population = "</span> &lt;&lt; HaloPopulation &lt;&lt; std::endl;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="keywordtype">unsigned</span> *ParticleCounter = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>];
<a name="l00437"></a>00437     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="AnalyzeSnap_8cpp.html#26cdc03eddc01de73d2183283e42f8ca">ParticleTypeTotal</a>; ++i)
<a name="l00438"></a>00438       ParticleCounter[i] = 0;
<a name="l00439"></a>00439     <span class="keywordtype">unsigned</span> *ParticleOffset = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>];
<a name="l00440"></a>00440     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="AnalyzeSnap_8cpp.html#8473fa3d28febd7487db0967e19fc5bf">HaloTypeTotal</a>; ++i)
<a name="l00441"></a>00441       ParticleOffset[i] = 0;
<a name="l00442"></a>00442     <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> *pos2 = <span class="keyword">new</span> <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>[3 * HaloPopulation];
<a name="l00443"></a>00443     <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> *vel2 = <span class="keyword">new</span> <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>[3 * HaloPopulation];
<a name="l00444"></a>00444     <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> *mass2 = <span class="keyword">new</span> <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a>[HaloPopulation];
<a name="l00445"></a>00445 
<a name="l00446"></a>00446     <a class="code" href="bu__AnalyzeSnap__Halo2_8cpp.html#e961128092ad9650ca0d54b8a2879a67" title="preparing halo2 change position of values in pos, vel, mass according to particle...">GenerateHalo2</a>( HaloPopulation, SnapshotParticles,
<a name="l00447"></a>00447                DoubleIndexMap,
<a name="l00448"></a>00448            ParticleCounter, ParticleOffset,
<a name="l00449"></a>00449            pos,  vel,  mass,pos2, vel2, mass2);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> Rvir = -1.0, Mvir = -1.0, Mtot = -1.0;
<a name="l00452"></a>00452     <a class="code" href="classVector3.html">Vector3</a> xcm, vcm, xmb;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> HaloTypeIterator = 0;
<a name="l00455"></a>00455      HaloTypeIterator &lt; HaloTypeTotal;
<a name="l00456"></a>00456      ++HaloTypeIterator) {
<a name="l00457"></a>00457       
<a name="l00458"></a>00458       std::cout &lt;&lt; <span class="stringliteral">" * * Creating halo from "</span>;
<a name="l00459"></a>00459       std::cout &lt;&lt; ParticleCounter[HaloTypeIterator];
<a name="l00460"></a>00460       std::cout &lt;&lt; <span class="stringliteral">" particles of type "</span>;
<a name="l00461"></a>00461       std::cout &lt;&lt; HaloTypeIterator;
<a name="l00462"></a>00462       std::cout &lt;&lt; <span class="stringliteral">" of a total "</span>;
<a name="l00463"></a>00463       std::cout &lt;&lt; HaloPopulation;
<a name="l00464"></a>00464       std::cout &lt;&lt; <span class="stringliteral">" with an offset of "</span>;
<a name="l00465"></a>00465       std::cout &lt;&lt; ParticleOffset[HaloTypeIterator];
<a name="l00466"></a>00466       std::cout &lt;&lt; std::endl;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468       <a class="code" href="classSimulation.html">Simulation</a> sim;
<a name="l00469"></a>00469       sim.<a class="code" href="classSimulation.html#6cd5d9b2efc9be5af7119ab78d0b033b">setZsnap</a>(Redshift);
<a name="l00470"></a>00470 
<a name="l00471"></a>00471       <a class="code" href="classHalo.html">Halo</a> halo = 
<a name="l00472"></a>00472     <a class="code" href="classHalo.html">Halo</a>(sim,
<a name="l00473"></a>00473          &amp;pos2[3*ParticleOffset[HaloTypeIterator]], 
<a name="l00474"></a>00474          &amp;vel2[3*ParticleOffset[HaloTypeIterator]], 
<a name="l00475"></a>00475          &amp;mass2[ParticleOffset[HaloTypeIterator]], 
<a name="l00476"></a>00476          ParticleCounter[HaloTypeIterator]);
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 <span class="preprocessor">#if 0 // if true: exclude unbound particles with procedure from Halo</span>
<a name="l00479"></a>00479 <span class="preprocessor"></span>      <a class="code" href="SystemCharacteristics_8cpp.html#5b25522225f9cc3d16b32059a125a93e">writelndebug</a>(<a class="code" href="SystemCharacteristics_8h.html#9c4ab189c2f018bc7ccc8ba4f6e04b9d">DEBUG</a>, <span class="stringliteral">" * * Cleaning unbound particles..."</span>);
<a name="l00480"></a>00480       std::vector &lt; bool &gt; exc(HaloPopulation);
<a name="l00481"></a>00481       halo.CleanUnboundExc(Boxsize, exc);
<a name="l00482"></a>00482       std::vector &lt; bool &gt; excs(HaloPopulation);
<a name="l00483"></a>00483       halo.CleanUnboundSimple(Boxsize, excs);
<a name="l00484"></a>00484       std::cout &lt;&lt; std::endl;
<a name="l00485"></a>00485 <span class="preprocessor">#else   // change all following calculations such that they have an exclusion list available</span>
<a name="l00486"></a>00486 <span class="preprocessor"></span><span class="preprocessor">#warning No additional exclusion of unbound particles!</span>
<a name="l00487"></a>00487 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00488"></a>00488 <span class="preprocessor"></span>
<a name="l00489"></a>00489 
<a name="l00491"></a>00491 <span class="comment">// properties of halo consisting of all particles</span>
<a name="l00493"></a>00493 <span class="comment"></span>      std::cout &lt;&lt; <span class="stringliteral">" * * Total mass:           "</span>;
<a name="l00494"></a>00494       Mtot = halo.<a class="code" href="classHalo.html#ace4451e5de161d6aa8707c5ee394f21">getMtot</a>();
<a name="l00495"></a>00495       std::cout &lt;&lt; Mtot &lt;&lt; std::endl;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497       <span class="keywordflow">if</span> (HaloTypeIterator == 0) {
<a name="l00498"></a>00498     std::cout &lt;&lt; <span class="stringliteral">" * * Center of mass:       "</span>;
<a name="l00499"></a>00499     halo.<a class="code" href="classHalo.html#aa531bfdbdff8f5f6aea7f82e260fcaf">getXCM</a>();
<a name="l00500"></a>00500     std::cout &lt;&lt; xcm;
<a name="l00501"></a>00501     std::cout &lt;&lt; std::endl;
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     std::cout &lt;&lt; <span class="stringliteral">" * * Center velocity:      "</span>;
<a name="l00504"></a>00504     halo.<a class="code" href="classHalo.html#2783350477ec2fede9d9e2fb891d35fc">getVCM</a>();
<a name="l00505"></a>00505     std::cout &lt;&lt; vcm;
<a name="l00506"></a>00506     std::cout &lt;&lt; std::endl;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508     std::cout &lt;&lt; <span class="stringliteral">" * * pos_mostbound:        "</span>;
<a name="l00509"></a>00509     halo.<a class="code" href="classHalo.html#7f3f8b61f172eb1af5a57721a8a9abae">getXMB</a>();
<a name="l00510"></a>00510     std::cout &lt;&lt; xmb;
<a name="l00511"></a>00511     std::cout &lt;&lt; std::endl;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513     <span class="comment">//std::cout &lt;&lt; " * * Centering on most bound particle...";</span>
<a name="l00514"></a>00514     <span class="comment">//halo.CenterOnMB(Boxsize);</span>
<a name="l00515"></a>00515     <span class="comment">//halo.CenterVel();</span>
<a name="l00516"></a>00516     <span class="comment">//std::cout &lt;&lt; std::endl;</span>
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     std::cout &lt;&lt; <span class="stringliteral">" * * Computing virial properties..."</span>;
<a name="l00519"></a>00519     <span class="comment">//halo.ComputeVirialProperties(rhobox, Mvir, Rvir);</span>
<a name="l00520"></a>00520     Mvir = halo.<a class="code" href="classHalo.html#4800137e9fe233e1cdb439e34b4dc723">getMvir</a>();
<a name="l00521"></a>00521     Rvir = halo.<a class="code" href="classHalo.html#b5a35a75689e2bc0ddb683e83e8be49b">getRvir</a>();
<a name="l00522"></a>00522     std::cout &lt;&lt; std::endl;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; <a class="code" href="AnalyzeSnap_8cpp.html#374a2ca2afb5f5b9be0d0038f6542b4e">Vhp_PosCM</a>.push_back(xcm(j)), ++j);
<a name="l00525"></a>00525     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; <a class="code" href="AnalyzeSnap_8cpp.html#b153b283e92c789466ce2a8c5be63b0e">Vhp_VelCM</a>.push_back(vcm(j)), ++j);
<a name="l00526"></a>00526     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; <a class="code" href="AnalyzeSnap_8cpp.html#22ce34b612f732f61f992e25cead92b2">Vhp_PosMB</a>.push_back(xmb(j)), ++j);
<a name="l00527"></a>00527     <a class="code" href="AnalyzeSnap_8cpp.html#d59448f336981875af49216ae63e804b">Vhp_Mvir</a>.push_back(Mvir);
<a name="l00528"></a>00528     <a class="code" href="AnalyzeSnap_8cpp.html#d85588f3aa5d2312c9153ae8cb68040a">Vhp_Rvir</a>.push_back(Rvir);
<a name="l00529"></a>00529       }
<a name="l00530"></a>00530 
<a name="l00532"></a>00532 <span class="comment">// properties by HP</span>
<a name="l00534"></a>00534 <span class="comment"></span>
<a name="l00535"></a>00535       <span class="comment">// else we have already a halo memory slot to store information into</span>
<a name="l00536"></a>00536       std::cout &lt;&lt; <span class="stringliteral">" * * Angular momentum:             "</span>;
<a name="l00537"></a>00537       <a class="code" href="classVector3.html">Vector3</a> J;
<a name="l00538"></a>00538       J = halo.<a class="code" href="classHalo.html#34a692fd7dc5dd279f55b97fbc236f2b">calcJ</a>();
<a name="l00539"></a>00539       std::cout &lt;&lt; J;
<a name="l00540"></a>00540       std::cout &lt;&lt; std::endl;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542       std::cout &lt;&lt; <span class="stringliteral">" * * Lambda':                      "</span>;
<a name="l00543"></a>00543       <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> lambda;
<a name="l00544"></a>00544       lambda = halo.<a class="code" href="classHalo.html#4145ed062e58c120505efd0d91588d8f" title="computes the simplified spin parameter lambda prime computes the halo spin parameter...">calcLambda</a>();
<a name="l00545"></a>00545       std::cout &lt;&lt; lambda;
<a name="l00546"></a>00546       std::cout &lt;&lt; std::endl;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548       std::cout &lt;&lt; <span class="stringliteral">" * * Sigma:                        "</span>;
<a name="l00549"></a>00549       <a class="code" href="SystemCharacteristics_8h.html#031f8951175b43076c2084a6c2173410">real</a> Sigma;
<a name="l00550"></a>00550       Sigma = halo.<a class="code" href="classHalo.html#dca19c76632c837c6af70a7c18bbe181">calcSigma</a>();
<a name="l00551"></a>00551       std::cout &lt;&lt; Sigma;
<a name="l00552"></a>00552       std::cout &lt;&lt; std::endl;
<a name="l00553"></a>00553 
<a name="l00554"></a>00554       std::cout &lt;&lt; <span class="stringliteral">" * * Axes..."</span>;
<a name="l00555"></a>00555       <a class="code" href="classVector3.html">Vector3</a> Eigenvalues;
<a name="l00556"></a>00556       std::vector&lt;Vector3&gt; Eigenvectors;
<a name="l00557"></a>00557       Eigenvalues = halo.<a class="code" href="classHalo.html#9e29d6549c4e2c88c62f45ca557e4c41">calcABC</a>();
<a name="l00558"></a>00558       Eigenvectors = halo.<a class="code" href="classHalo.html#c6aba51fd077f561d933c6b9eca17bff">calcEV</a>().<a class="code" href="classMatrix33.html#802dfcb7f542f0bff8e232003252d044">toVecVector3</a>();
<a name="l00559"></a>00559       std::cout &lt;&lt; std::endl;
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       <a class="code" href="AnalyzeSnap_8cpp.html#ac7f4e8e49192d6ed40adaa5bd066a18" title="Push back all HP outputs for the different halos Push back onto the Vhp_ vectors...">PushBackHPoutput</a>(HaloTypeIterator, J, Eigenvectors, Eigenvalues, lambda, Mtot, Sigma);
<a name="l00562"></a>00562     }    <span class="comment">// next HaloTypeIterator</span>
<a name="l00563"></a>00563 
<a name="l00565"></a>00565 <span class="comment">// cleaning</span>
<a name="l00567"></a>00567 <span class="comment"></span>
<a name="l00568"></a>00568     <a class="code" href="SystemCharacteristics_8cpp.html#865c3c98145e9535ae7575ff0161119d">writedebug</a>(<span class="keyword">false</span>, <span class="stringliteral">" * * Deleting arrays from halo2..."</span>);
<a name="l00569"></a>00569     <span class="keyword">delete</span>[] pos2;
<a name="l00570"></a>00570     <span class="keyword">delete</span>[] vel2;
<a name="l00571"></a>00571     <span class="keyword">delete</span>[] mass2;
<a name="l00572"></a>00572 
<a name="l00573"></a>00573   }  <span class="comment">// next halo</span>
<a name="l00574"></a>00574   <span class="keyword">delete</span>[] id;
<a name="l00575"></a>00575   <span class="keyword">delete</span>[] pos;
<a name="l00576"></a>00576   <span class="keyword">delete</span>[] vel;
<a name="l00577"></a>00577   <span class="keyword">delete</span>[] mass;
<a name="l00578"></a>00578   SnapshotParticles.close();
<a name="l00579"></a>00579 
<a name="l00580"></a>00580   <a class="code" href="AnalyzeSnap_8cpp.html#46c32ccad62a2215cbf8c0d9311e9094">Storeahf</a>(isnap);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582   <a class="code" href="AnalyzeSnap_8cpp.html#83176b9b9f1be1130b6d6ea1492db992" title="write all calculated properties into a HDF5 file This function takes all publicly...">WriteHDF5</a>(<a class="code" href="SystemCharacteristics_8cpp.html#d3867aaa410297f271cb4a5f443f368c">Folder</a>(<span class="stringliteral">"output"</span>) + <a class="code" href="SystemCharacteristics_8cpp.html#b95a6a07eed667f94b0951a15f1a9b0e">Snaps</a>(isnap) + <span class="stringliteral">"/extra.hdf5"</span>, 
<a name="l00583"></a>00583         Boxsize, Redshift, HaloTotCount);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585   <a class="code" href="SystemCharacteristics_8cpp.html#37de7b6ae4852c4084f30507d58eb906">writeln</a>(<span class="stringliteral">"Success."</span>);
<a name="l00586"></a>00586   <span class="keywordflow">return</span>;
<a name="l00587"></a>00587 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Mar 22 16:59:23 2010 for amateur by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
